<mxfile host="app.diagrams.net" modified="2025-01-20T00:00:00.000Z" agent="5.0" version="21.6.5" type="device">
  <diagram name="PAROL6架构图" id="parol6-arch">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- 背景 -->
        <mxCell id="bg" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry width="1600" height="1200" as="geometry" />
        </mxCell>

        <!-- 标题 -->
        <mxCell id="title" value="PAROL6 LeRobot &amp; ROS2 集成架构" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>

        <!-- 第1层：应用层 -->
        <mxCell id="app-layer-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;opacity=60;" vertex="1" parent="1">
          <mxGeometry x="100" y="100" width="1400" height="180" as="geometry" />
        </mxCell>

        <mxCell id="app-layer-title" value="应用层 (LeRobot 工作流)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#0D47A1;" vertex="1" parent="1">
          <mxGeometry x="120" y="110" width="300" height="30" as="geometry" />
        </mxCell>

        <!-- 应用模块 -->
        <mxCell id="app-teleoperate" value="&lt;b&gt;遥操作&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: teleoperate.py&lt;br&gt;函数: main()&lt;br&gt;&lt;br&gt;控制方式:&lt;br&gt;• Joycon 输入&lt;br&gt;• 键盘控制" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976D2;strokeColor=#0D47A1;strokeWidth=2;fontColor=#FFFFFF;fontSize=12;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="140" y="150" width="180" height="110" as="geometry" />
        </mxCell>

        <mxCell id="app-record" value="&lt;b&gt;数据采集&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: record.py&lt;br&gt;函数: record_episode()&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• episode_time_s: 30&lt;br&gt;• num_episodes: 50" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976D2;strokeColor=#0D47A1;strokeWidth=2;fontColor=#FFFFFF;fontSize=12;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="360" y="150" width="180" height="110" as="geometry" />
        </mxCell>

        <mxCell id="app-train" value="&lt;b&gt;模型训练&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: train.py&lt;br&gt;函数: train()&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• policy: smolvla_base&lt;br&gt;• batch_size: 8&lt;br&gt;• steps: 20000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976D2;strokeColor=#0D47A1;strokeWidth=2;fontColor=#FFFFFF;fontSize=12;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="580" y="150" width="180" height="110" as="geometry" />
        </mxCell>

        <mxCell id="app-inference" value="&lt;b&gt;模型推理&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: record.py&lt;br&gt;函数: inference()&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• policy.path: checkpoint&lt;br&gt;• use_policy: true" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976D2;strokeColor=#0D47A1;strokeWidth=2;fontColor=#FFFFFF;fontSize=12;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="800" y="150" width="180" height="110" as="geometry" />
        </mxCell>

        <mxCell id="app-simulation" value="&lt;b&gt;仿真环境&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: test_parol6_robosuite.py&lt;br&gt;函数: test_robosuite_basic()&lt;br&gt;&lt;br&gt;环境:&lt;br&gt;• Robosuite (UR5e)&lt;br&gt;• 控制频率: 20Hz" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#43A047;strokeColor=#2E7D32;strokeWidth=2;fontColor=#FFFFFF;fontSize=12;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="1020" y="150" width="200" height="110" as="geometry" />
        </mxCell>

        <!-- 第2层：机器人接口层 -->
        <mxCell id="robot-layer-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;strokeWidth=2;opacity=60;" vertex="1" parent="1">
          <mxGeometry x="100" y="320" width="1400" height="220" as="geometry" />
        </mxCell>

        <mxCell id="robot-layer-title" value="机器人接口层 (PAROL6 类)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#BF360C;" vertex="1" parent="1">
          <mxGeometry x="120" y="330" width="350" height="30" as="geometry" />
        </mxCell>

        <!-- 机器人配置 -->
        <mxCell id="robot-config" value="&lt;b&gt;PAROL6 配置&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: config_parol6.py&lt;br&gt;类: Parol6Config&lt;br&gt;&lt;br&gt;参数:&lt;br&gt;• port: /dev/ttyUSB0&lt;br&gt;• baudrate: 115200&lt;br&gt;• use_ros2_bridge: bool&lt;br&gt;• max_relative_target: 0.5&lt;br&gt;• control_frequency: 100Hz&lt;br&gt;• joint_limits: dict&lt;br&gt;• enable_position_filter: true&lt;br&gt;• position_filter_coeff: 0.8" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF6F00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="140" y="370" width="260" height="150" as="geometry" />
        </mxCell>

        <!-- 机器人控制 -->
        <mxCell id="robot-control" value="&lt;b&gt;PAROL6 机器人类&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: parol6.py&lt;br&gt;类: Parol6&lt;br&gt;&lt;br&gt;主要函数:&lt;br&gt;• connect() - 初始化连接&lt;br&gt;• disconnect() - 关闭连接&lt;br&gt;• get_observation() - 读取状态&lt;br&gt;• send_action() - 发送命令&lt;br&gt;• calibrate() - 验证限制&lt;br&gt;&lt;br&gt;特性:&lt;br&gt;• 6自由度关节控制&lt;br&gt;• 相机集成&lt;br&gt;• 安全限制&lt;br&gt;• 位置过滤" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF6F00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="440" y="370" width="280" height="150" as="geometry" />
        </mxCell>

        <!-- 关节配置 -->
        <mxCell id="robot-joints" value="&lt;b&gt;关节配置&lt;/b&gt;&lt;br&gt;&lt;br&gt;关节 (6自由度):&lt;br&gt;• shoulder_pan (肩部旋转)&lt;br&gt;• shoulder_lift (肩部抬升)&lt;br&gt;• elbow (肘关节)&lt;br&gt;• wrist_1 (腕关节1)&lt;br&gt;• wrist_2 (腕关节2)&lt;br&gt;• wrist_3 (腕关节3)&lt;br&gt;&lt;br&gt;初始位置:&lt;br&gt;[0.0, -1.57, 1.57,&lt;br&gt; -1.57, -1.57, 0.0]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F57C00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="760" y="370" width="200" height="150" as="geometry" />
        </mxCell>

        <!-- 相机集成 -->
        <mxCell id="robot-camera" value="&lt;b&gt;相机集成&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: cameras/opencv.py&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• type: opencv&lt;br&gt;• width: 640&lt;br&gt;• height: 480&lt;br&gt;• fps: 30&lt;br&gt;&lt;br&gt;函数:&lt;br&gt;• async_read()&lt;br&gt;• connect()&lt;br&gt;• disconnect()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F57C00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="1000" y="370" width="200" height="150" as="geometry" />
        </mxCell>

        <!-- 安全功能 -->
        <mxCell id="robot-safety" value="&lt;b&gt;安全功能&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: utils.py&lt;br&gt;函数:&lt;br&gt;ensure_safe_goal_position()&lt;br&gt;&lt;br&gt;检查项:&lt;br&gt;• 关节限制&lt;br&gt;• 最大相对目标&lt;br&gt;• 位置裁剪&lt;br&gt;• 速度限制" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F57C00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="1240" y="370" width="220" height="150" as="geometry" />
        </mxCell>

        <!-- 第3层：通信层 -->
        <mxCell id="comm-layer-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#6A1B9A;strokeWidth=2;opacity=60;" vertex="1" parent="1">
          <mxGeometry x="100" y="580" width="1400" height="200" as="geometry" />
        </mxCell>

        <mxCell id="comm-layer-title" value="通信层" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#4A148C;" vertex="1" parent="1">
          <mxGeometry x="120" y="590" width="250" height="30" as="geometry" />
        </mxCell>

        <!-- 串口通信 -->
        <mxCell id="comm-serial" value="&lt;b&gt;串口通信&lt;/b&gt;&lt;br&gt;&lt;br&gt;库: pyserial&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• 端口: /dev/ttyUSB0&lt;br&gt;• 波特率: 115200&lt;br&gt;• 超时: 1.0s&lt;br&gt;&lt;br&gt;协议:&lt;br&gt;• 命令: MOVE,j0,j1,...,j5&lt;br&gt;• 响应: OK/ERROR&lt;br&gt;&lt;br&gt;函数:&lt;br&gt;• _send_joint_positions()&lt;br&gt;• _read_joint_positions()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="180" y="630" width="260" height="130" as="geometry" />
        </mxCell>

        <!-- ROS2 桥接 -->
        <mxCell id="comm-ros2-bridge" value="&lt;b&gt;ROS2 桥接&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: parol6_ros2_bridge.py&lt;br&gt;类: Parol6ROS2Bridge&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• namespace: /parol6&lt;br&gt;• control_frequency: 100Hz&lt;br&gt;&lt;br&gt;函数:&lt;br&gt;• connect() - 初始化ROS2&lt;br&gt;• disconnect() - 关闭&lt;br&gt;• send_joint_positions(pos)&lt;br&gt;• get_joint_positions() → np.array&lt;br&gt;• get_joint_velocities() → np.array&lt;br&gt;• _joint_state_callback(pos, vel)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="520" y="630" width="300" height="130" as="geometry" />
        </mxCell>

        <!-- ROS2 节点 -->
        <mxCell id="comm-ros2-node" value="&lt;b&gt;ROS2 节点&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: parol6_ros2_node.py&lt;br&gt;类: Parol6ROS2Node&lt;br&gt;&lt;br&gt;发布话题:&lt;br&gt;• /parol6/joint_states&lt;br&gt;  (sensor_msgs/JointState)&lt;br&gt;• /parol6/joint_trajectory_controller/state&lt;br&gt;  (control_msgs/JointTrajectoryControllerState)&lt;br&gt;&lt;br&gt;订阅话题:&lt;br&gt;• /parol6/joint_trajectory_controller/joint_trajectory&lt;br&gt;  (trajectory_msgs/JointTrajectory)&lt;br&gt;• /parol6/joint_commands&lt;br&gt;  (sensor_msgs/JointState)&lt;br&gt;&lt;br&gt;函数:&lt;br&gt;• publish_joint_state()&lt;br&gt;• joint_command_callback(msg)&lt;br&gt;• publish_controller_state()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="900" y="630" width="380" height="130" as="geometry" />
        </mxCell>

        <!-- 第4层：硬件/仿真层 -->
        <mxCell id="hw-layer-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;opacity=60;" vertex="1" parent="1">
          <mxGeometry x="100" y="820" width="1400" height="160" as="geometry" />
        </mxCell>

        <mxCell id="hw-layer-title" value="硬件与仿真层" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1B5E20;" vertex="1" parent="1">
          <mxGeometry x="120" y="830" width="300" height="30" as="geometry" />
        </mxCell>

        <!-- 硬件 -->
        <mxCell id="hw-parol6" value="&lt;b&gt;PAROL6 硬件&lt;/b&gt;&lt;br&gt;&lt;br&gt;规格:&lt;br&gt;• 自由度: 6 (类似 UR5)&lt;br&gt;• 最大速度: 3.15 rad/s&lt;br&gt;• 最大加速度: 10 rad/s²&lt;br&gt;• 通信方式: USB/串口&lt;br&gt;&lt;br&gt;关节:&lt;br&gt;• 所有关节: ±180° 范围&lt;br&gt;• 位置控制模式&lt;br&gt;&lt;br&gt;接口:&lt;br&gt;• 串口: /dev/ttyUSB0&lt;br&gt;• 波特率: 115200" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#43A047;strokeColor=#2E7D32;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="200" y="870" width="300" height="90" as="geometry" />
        </mxCell>

        <!-- Robosuite -->
        <mxCell id="hw-robosuite" value="&lt;b&gt;Robosuite 仿真&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件: test_parol6_robosuite.py&lt;br&gt;&lt;br&gt;配置:&lt;br&gt;• env_name: Lift, Stack 等&lt;br&gt;• robots: UR5e (PAROL6代理)&lt;br&gt;• control_freq: 20Hz&lt;br&gt;• has_renderer: true&lt;br&gt;&lt;br&gt;函数:&lt;br&gt;• test_robosuite_basic()&lt;br&gt;• test_parol6_robosuite_integration()&lt;br&gt;• test_robosuite_teleoperation()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#43A047;strokeColor=#2E7D32;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="580" y="870" width="380" height="90" as="geometry" />
        </mxCell>

        <!-- 脚本 -->
        <mxCell id="hw-scripts" value="&lt;b&gt;启动脚本&lt;/b&gt;&lt;br&gt;&lt;br&gt;文件:&lt;br&gt;• scripts/parol6/start_parol6_ros2.sh&lt;br&gt;• ros2_adapter/launch/parol6_bringup.launch.py&lt;br&gt;&lt;br&gt;测试:&lt;br&gt;• scripts/parol6/test_parol6_lerobot.py&lt;br&gt;• tests/parol6/test_ros2_integration.py&lt;br&gt;&lt;br&gt;示例:&lt;br&gt;• examples/parol6_example.py" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#2E7D32;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="1040" y="870" width="380" height="90" as="geometry" />
        </mxCell>

        <!-- 箭头：应用 -> 机器人 -->
        <mxCell id="arrow-app-robot1" value="" style="endArrow=classic;html=1;strokeColor=#1976D2;strokeWidth=3;exitX=0.5;exitY=1;entryX=0.167;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="app-teleoperate" target="robot-control">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-app-robot2" value="" style="endArrow=classic;html=1;strokeColor=#1976D2;strokeWidth=3;exitX=0.5;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="app-record" target="robot-control">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-app-robot3" value="" style="endArrow=classic;html=1;strokeColor=#1976D2;strokeWidth=3;exitX=0.5;exitY=1;entryX=0.833;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="app-inference" target="robot-control">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 箭头：仿真 -> 机器人 -->
        <mxCell id="arrow-sim-robot" value="测试验证" style="endArrow=classic;html=1;strokeColor=#43A047;strokeWidth=3;exitX=0;exitY=0.75;entryX=1;entryY=0.25;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;labelBackgroundColor=#FFFFFF;fontColor=#2E7D32;fontSize=12;fontStyle=1;" edge="1" parent="1" source="app-simulation" target="robot-control">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="900" y="233" />
              <mxPoint x="900" y="408" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- 箭头：机器人 -> 配置 -->
        <mxCell id="arrow-robot-config" value="使用" style="endArrow=classic;html=1;strokeColor=#FF6F00;strokeWidth=2;exitX=0;exitY=0.5;entryX=1;entryY=0.5;entryDx=0;entryDy=0;dashed=1;labelBackgroundColor=#FFFFFF;fontColor=#E65100;fontSize=11;" edge="1" parent="1" source="robot-control" target="robot-config">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 箭头：机器人 -> 关节 -->
        <mxCell id="arrow-robot-joints" value="控制" style="endArrow=classic;html=1;strokeColor=#FF6F00;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;labelBackgroundColor=#FFFFFF;fontColor=#E65100;fontSize=11;" edge="1" parent="1" source="robot-control" target="robot-joints">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 箭头：机器人 -> 相机 -->
        <mxCell id="arrow-robot-camera" value="读取" style="endArrow=classic;html=1;strokeColor=#FF6F00;strokeWidth=2;exitX=0.857;exitY=1;entryX=0;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;labelBackgroundColor=#FFFFFF;fontColor=#E65100;fontSize=11;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="robot-control" target="robot-camera">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="680" y="550" />
              <mxPoint x="1000" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- 箭头：机器人 -> 安全 -->
        <mxCell id="arrow-robot-safety" value="验证" style="endArrow=classic;html=1;strokeColor=#FF6F00;strokeWidth=2;exitX=1;exitY=0.75;entryX=0;entryY=0.25;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;labelBackgroundColor=#FFFFFF;fontColor=#E65100;fontSize=11;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="robot-control" target="robot-safety">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1100" y="483" />
              <mxPoint x="1100" y="408" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- 箭头：机器人 -> 通信 -->
        <mxCell id="arrow-robot-serial" value="串口模式" style="endArrow=classic;html=1;strokeColor=#7B1FA2;strokeWidth=3;exitX=0.25;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;labelBackgroundColor=#FFFFFF;fontColor=#4A148C;fontSize=12;fontStyle=1;" edge="1" parent="1" source="robot-control" target="comm-serial">
          <mxGeometry x="-0.2" width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="510" y="580" />
              <mxPoint x="310" y="580" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-robot-ros2" value="ROS2模式" style="endArrow=classic;html=1;strokeColor=#7B1FA2;strokeWidth=3;exitX=0.75;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;labelBackgroundColor=#FFFFFF;fontColor=#4A148C;fontSize=12;fontStyle=1;" edge="1" parent="1" source="robot-control" target="comm-ros2-bridge">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="500" as="sourcePoint" />
            <mxPoint x="750" y="450" as="targetPoint" />
            <Array as="points">
              <mxPoint x="650" y="580" />
              <mxPoint x="670" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- 箭头：ROS2桥接 -> 节点 -->
        <mxCell id="arrow-bridge-node" value="使用" style="endArrow=classic;html=1;strokeColor=#7B1FA2;strokeWidth=2;exitX=1;exitY=0.5;entryX=0;entryY=0.5;entryDx=0;entryDy=0;labelBackgroundColor=#FFFFFF;fontColor=#4A148C;fontSize=11;" edge="1" parent="1" source="comm-ros2-bridge" target="comm-ros2-node">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="700" as="sourcePoint" />
            <mxPoint x="750" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 箭头：通信 -> 硬件 -->
        <mxCell id="arrow-serial-hw" value="USB/串口" style="endArrow=classic;html=1;strokeColor=#43A047;strokeWidth=3;exitX=0.5;exitY=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;labelBackgroundColor=#FFFFFF;fontColor=#2E7D32;fontSize=12;fontStyle=1;" edge="1" parent="1" source="comm-serial" target="hw-parol6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="900" as="sourcePoint" />
            <mxPoint x="750" y="850" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="arrow-ros2-hw" value="ROS2话题" style="endArrow=classic;html=1;strokeColor=#43A047;strokeWidth=3;exitX=0.25;exitY=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;labelBackgroundColor=#FFFFFF;fontColor=#2E7D32;fontSize=12;fontStyle=1;" edge="1" parent="1" source="comm-ros2-node" target="hw-parol6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="900" as="sourcePoint" />
            <mxPoint x="750" y="850" as="targetPoint" />
            <Array as="points">
              <mxPoint x="995" y="800" />
              <mxPoint x="425" y="800" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- 箭头：Robosuite连接 -->
        <mxCell id="arrow-sim-robosuite" value="测试环境" style="endArrow=classic;html=1;strokeColor=#43A047;strokeWidth=3;exitX=0.75;exitY=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;labelBackgroundColor=#FFFFFF;fontColor=#2E7D32;fontSize=12;fontStyle=1;" edge="1" parent="1" source="comm-ros2-node" target="hw-robosuite">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="900" as="sourcePoint" />
            <mxPoint x="750" y="850" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <!-- 图例 -->
        <mxCell id="legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#424242;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="100" y="1020" width="1400" height="150" as="geometry" />
        </mxCell>

        <mxCell id="legend-title" value="图例与关键信息" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="120" y="1030" width="250" height="30" as="geometry" />
        </mxCell>

        <!-- 图例项 -->
        <mxCell id="legend-app" value="应用层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1976D2;strokeColor=#0D47A1;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="140" y="1070" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-robot" value="机器人接口层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FF6F00;strokeColor=#E65100;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="310" y="1070" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-comm" value="通信层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7B1FA2;strokeColor=#4A148C;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="480" y="1070" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-hw" value="硬件/仿真层" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#43A047;strokeColor=#2E7D32;strokeWidth=2;fontColor=#FFFFFF;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="650" y="1070" width="150" height="30" as="geometry" />
        </mxCell>

        <!-- 关键特性 -->
        <mxCell id="key-features" value="&lt;b&gt;主要特性:&lt;/b&gt;&lt;br&gt;• 6自由度关节控制 (类似 UR5)&lt;br&gt;• 双模式通信: 串口和ROS2&lt;br&gt;• 安全功能: 关节限制、位置过滤&lt;br&gt;• 控制频率: 100Hz&lt;br&gt;• 相机集成支持" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="140" y="1110" width="300" height="50" as="geometry" />
        </mxCell>

        <mxCell id="key-files" value="&lt;b&gt;重要文件:&lt;/b&gt;&lt;br&gt;• lerobot/common/robots/parol6/parol6.py&lt;br&gt;• ros2_adapter/parol6_adapter/parol6_ros2_bridge.py&lt;br&gt;• ros2_adapter/parol6_adapter/parol6_ros2_node.py&lt;br&gt;• tests/parol6/test_parol6_robosuite.py" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="480" y="1110" width="400" height="50" as="geometry" />
        </mxCell>

        <mxCell id="key-config" value="&lt;b&gt;关键配置:&lt;/b&gt;&lt;br&gt;• 端口: /dev/ttyUSB0&lt;br&gt;• 波特率: 115200&lt;br&gt;• ROS2命名空间: /parol6&lt;br&gt;• 最大相对目标: 0.5" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="920" y="1110" width="250" height="50" as="geometry" />
        </mxCell>

        <mxCell id="key-tests" value="&lt;b&gt;测试命令:&lt;/b&gt;&lt;br&gt;python tests/parol6/test_parol6_robosuite.py --test all&lt;br&gt;python tests/parol6/test_ros2_integration.py --test all&lt;br&gt;python examples/parol6_example.py --example basic" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#1A1A1A;" vertex="1" parent="1">
          <mxGeometry x="1200" y="1110" width="280" height="50" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
